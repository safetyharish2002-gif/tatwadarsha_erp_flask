<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ title or 'Receipts' }}</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    background: #0f1724;
    color: #e6eef8;
    font-family: Arial, Helvetica, sans-serif;
  }
  .glass-card{
    background: rgba(255,255,255,0.05);
    padding: 1rem;
    border-radius: 12px;
    border:1px solid rgba(255,255,255,0.1);
  }
  .table thead th{
    color:#fff;
    border-bottom:1px solid rgba(255,255,255,0.2);
  }
  .table tbody td{
    color:#e6eef8;
  }
</style>

</head>
<body>

<div class="container py-4">

  <div class="d-flex justify-content-between mb-3">
    <h4>Fee Receipts</h4>

    <div>
      <input id="f-student" class="form-control form-control-sm d-inline-block" 
             style="width:200px" placeholder="Student ID">

      <button class="btn btn-primary btn-sm" id="btn-filter">
        Search
      </button>
    </div>
  </div>

  <div class="glass-card">
    <table class="table table-dark table-striped" id="receipts-table">
      <thead>
        <tr>
          <th>Receipt No</th>
          <th>Student</th>
          <th>Head</th>
          <th>Amount</th>
          <th>Mode</th>
          <th>Print</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>


<script>
async function loadReceipts(){

  let sid = document.getElementById("f-student").value.trim();
  let url = "/fees/api/receipts";

  if(sid){
    url += "?student_id=" + encodeURIComponent(sid);
  }

  const res = await fetch(url);
  const j = await res.json();

  let tb = document.querySelector("#receipts-table tbody");
  tb.innerHTML = "";

  if(j.success){
    j.items.forEach(r => {

      let tr = document.createElement("tr");

      tr.innerHTML = `
        <td>${r.receipt_no}</td>
        <td>${r.student_id}</td>
        <td>${r.head_name || ''}</td>
        <td>â‚¹ ${Number(r.paid_amount).toFixed(2)}</td>
        <td>${r.payment_mode || ''}</td>
        <td>
          <a href="/fees/receipt/view/${r.receipt_id}" 
             target="_blank" 
             class="btn btn-outline-light btn-sm">
             ðŸ–¨ Print
          </a>
        </td>
      `;

      tb.appendChild(tr);
    });
  }
}

document.getElementById("btn-filter").onclick = loadReceipts;

// Auto-load receipts
loadReceipts();
</script>

</body>
</html>
